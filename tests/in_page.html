<!doctype html>
<html><head>
<!-- <script type="text/javascript" src="../buryat.js"></script> -->
<script src="../buryat.js"></script>
</head>

<body>

<div id="inforows"></div>

<input id="db_ins_txt" type="text"></input>
<button id="db_ins_btn" >Press Me</button>


<script>
document.getElementById('db_ins_btn').onclick = function() {
    var t = document.getElementById('db_ins_txt');
    db.insert( {text:t.value} );
    t.value = "";
    draw_rows();
};
// bind enter key body-wide to BUTTON
document.body.onkeydown = function(e) {
    if ( e.keyCode === 13 ) {
        document.getElementById('db_ins_btn').onclick();
    }
};

var db = buryat.open(); // TODO: be able to supply a key-name here, defaults to buryat
//db.insert( [{text:"I"},{text:"Love"},{text:"You"},{text:"Ivette"}] );

function rows_render()
{
    var res = db.find(/.*/); // all rows
    var inforows = document.getElementById('inforows');

    do {
        var last = inforows.lastChild;
        if ( !last )
            break;
        inforows.removeChild( last );
    } while (1);

    res._data.forEach(function(val,i){
        var e = document.createElement('div');
        e.innerHTML = val.text;
        inforows.appendChild(e);
    });

}

function draw_rows() {
    rows_render();
    db.save(); // save what we see
}

draw_rows();

</script>


</body>
</html>
